<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8 /> 
		<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui' />
		<title>ObservatorioTerritorialGC</title>
		<link rel="shortcut icon" type="image/x-icon" href="favicon1.png">

		<!-- CSS -->
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css">
		<link rel="stylesheet" href="css/Leaflet.PolylineMeasure.css">
		<link rel="stylesheet" href="css/leaflet.groupedlayercontrol.min.css">
		<style type="text/css">	
			.leaflet-control-attribution.leaflet-control a:hover {color:#800080}
			.logogc{position:absolute;z-index:2;top:5px;right:350px}
			h1 { color: #800080;}
			.leaflet-control-attribution.leaflet-control { font-size: 16px;	}
			
			@font-face {
				font-family: Gotham;
				src: url(fonts/Gotham-Book.otf);
				font-weight: normal;
			}

			@font-face {
				font-family: Gotham;
				src: url(fonts/Gotham-Bold.otf);
				font-weight: bold;
			}
			
			.leaflet-container {
				font: 13px/1.5 Gotham;
			}
			
		    #referencias {
				position: absolute;
				width: 150px;
				height: 50%;
				top: 40%;
				left: 20px;
				z-index: 400;
		    }

		    .icono_referencia {
				display: none;
				font: 18px/1.5 Gotham;
				color: #222222;
				margin-bottom: 15px;
				text-align: left;
				background-color: rgba(255, 255, 255, 0.4);
				border-color: #444444;
				border-width: 3px;
				border-style: solid;
				padding: 10px;
		    }
		
		</style>
		
		<!-- SCRIPTS -->
		<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
		<script src="scripts/Leaflet.PolylineMeasure.js"></script>
		<script src="scripts/leaflet.pattern.js"></script>
		<script src="scripts/leaflet-tilelayer-wmts.js"></script>
		<script src="scripts/leaflet.groupedlayercontrol.min.js"></script>
		<script src="scripts/Bing.js"></script>
		
		
		<!-- GEOJSON -->
		
		<script type="text/javascript" src="scripts/godoycruz.js"></script>
		
		
		<script type="text/javascript" src="scripts/ZonaNatural.js"></script>
		<script type="text/javascript" src="scripts/ZonaUrbana.js"></script>
		<script type="text/javascript" src="scripts/LimiteUrbano.js"></script>
        <script type="text/javascript" src="scripts/DistritosDepartamentales.js"></script>
		<script type="text/javascript" src="scripts/ParcelasZonificadas1.min.js"></script>
		<script type="text/javascript" src="scripts/ParcelasZonificadas2.min.js"></script>
		<script type="text/javascript" src="scripts/ParcelasZonificadas3.min.js"></script>
	</head>
	<body> 
		<h1 style="position: relative; margin-top: 10px; margin-left: 100px; z-index: 2">Observatorio Territorial de Godoy Cruz</h1>
		<img src="favicon.png" height= "45px" width="45px" align=right class="logogc">
		<div id="map" class="map map-home" style="margin:8px 0 8px 0;height:680px;"></div> 
		<div id="referencias">
			<div class="icono_referencia" id="ref_cicloviasproy">Total de km:</br>29,35</div>
			<div class="icono_referencia" id="ref_cicloviasexist">Total de km:</br>21,48</div>
			
		</div>
	

		<!-- FUNCIONES LEAFLET -->
		<script>
			/* ARGENMAP */
			var mapabase_argenmap = new L.TileLayer.WMTS( 'https://wms.ign.gob.ar/geoserver/capabaseargenmap/gwc/service/wmts?' , {
				layer: 'capabaseargenmap',
				style: "normal",
				tilematrixSet: "EPSG:3857",
				format: "image/png",
				attribution: " <a href='https://www.ign.gob.ar/AreaServicios/Argenmap/IntroduccionV2'> IGN - Argenmap v2 </a> | <a href='https://www.godoycruz.gob.ar/'>Secretaria de Ambiente y Desarrollo Sustentable - Godoy Cruz</a> | <a href='https://github.com/mylen/leaflet.TileLayer.WMTS'>GitHub</a>&copy "
			});
			
			/* ICONOS */
			var iconoComun = L.Icon.extend({
				options: {
					shadowUrl: 'img/marker-shadow.png',
					iconSize:     [25, 41],
					shadowSize:   [41, 41],
					iconAnchor:   [12, 41],
					popupAnchor:  [1, -34]
				}
			});

			
	
			/* POPUPS */
			
			function agregarPopupparcelas(feature, layer) { 
				if (feature.properties && feature.properties.ZONIFIC) { 
						layer.bindPopup( "<strong><br/>"+ "Área:<strong>"+ feature.properties.ZONIFIC + "</strong><br/>" +"FOS en parcelas de 100 a 500 m2: <strong>"+feature.properties.FOS_1 + "</strong><br/>" +"FOS en parcelas de 501 a 1000 m2: <strong>"+ feature.properties.FOS_2 + "</strong><br/>" 
						+"FOS en parcelas de 1001m2 en adelante: <strong>"+ feature.properties.FOS_3 + "</strong><br/>" +"FOT en parcelas de 100 a 500 m2: <strong>"+ feature.properties.FOT_1+ "</strong><br/>" +"FOT en parcelasde 501 a 1000 m2: <strong>" +feature.properties.FOT_2 + "</strong><br/>" +"FOT en parcelas de 1000m2 en adelante: <strong>"+ feature.properties.FOS_3 
						+ "</strong><br/>" +"Altura máxima en metros: <strong>"+feature.properties.ALTURA_MAX);
				} 
			}
			
			function estiloZonificacion() {
				const capasparce = [parce1, parce2, parce3];
				
				capasparce.forEach(function (capaactual) {
					capaactual.eachLayer(function(featureInstanceLayer) {
						var id_feature = featureInstanceLayer.feature.properties['ZONIFIC'];
						if (id_feature == 'Comercial') {
							color_actual = 'grey';
						} else if (id_feature == 'Residencial Mixta') {
							color_actual = '#FF0000';
						} else if (id_feature == 'Residencial Mixta 1') {
							color_actual = '#ff7f00';
						} else if (id_feature == 'Comercial Mixta') {
							color_actual = '#fff600';
						} else if (id_feature == 'Industrial 1') {
							color_actual = '#800080';
						} else if (id_feature == 'Industrial 2') {
							color_actual = '#5d3064';
						}else if (id_feature == 'Extension Industrial') {
							color_actual = '#1feeb4';
						}else if (id_feature == 'Residencial r6') {
							color_actual = '#199f2d';
						}else if (id_feature == 'Residencial r1-r2-r3-r4-r5') {
							color_actual = '#74d1af';
						}else if (id_feature == 'Centro Civico') {
							color_actual = '#2f6e9e';
						}else if (id_feature == 'Cultural') {
							color_actual = '#b31417';
						}else if (id_feature == 'Parque Recreacion') {
							color_actual = '#E1E1E1';
						}else if (id_feature == 'Ejes Residenciales Especiales') {
							color_actual = 'blue';
						}else if (id_feature == 'Cementerio') {
							color_actual = 'orange';
						}
						featureInstanceLayer.setStyle({
							color: color_actual,fillOpacity: 0.35
						});
					});
				});
			}	
			
			
			/* BASE LAYERS */
			var osmUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
				osmAttrib = '&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a> contributors',
				mapabase_osm = L.tileLayer(osmUrl, {maxZoom: 20, attribution: osmAttrib});
			var otUrl = 'https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',
				otAttrib = 'Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)',
				mapabase_ot = L.tileLayer(otUrl, {maxZoom: 20, attribution: otAttrib});
			var mapa_bing = L.bingLayer('AggHCsJIZIwHrL4Bm6Bt7O1JMXRVk6ca6IoFkILGNWFSl3RAWg-RuYq2jG5VzpIK');
							
			/* OVERLAYS Y GRUPOS */
			var plazagc = L.marker([-32.92524, -68.84439]).bindPopup('Plaza GC.').openPopup(),
				godoycruz = L.geoJson(godoycruz),
				parce1= L.geoJson(ParcelasZonificadas1, { onEachFeature: agregarPopupparcelas}),
				parce2= L.geoJson(ParcelasZonificadas2, { onEachFeature: agregarPopupparcelas}),
				parce3= L.geoJson(ParcelasZonificadas3, { onEachFeature: agregarPopupparcelas}),
				parcegrupo= L.layerGroup([parce1, parce2, parce3]);
				
				

			/* CREACIÓN DEL MAPA CON BASE LAYERS Y OVERLAYS */
			var map = L.map('map', {
				layers: [mapa_bing,godoycruz]
			}).setView([-32.9314, -68.8497], 13);
			
			/* FUNCIONES DE ESTILO DE OVERLAYS */
			estiloZonificacion();
			
          
			/* CREACIÓN DEL LAYERS CONTROL */
			var baseMaps = {
				"OpenTopoMap": mapabase_ot,
				 "Argenmap": mapabase_argenmap,
				 "Satelite Bing": mapa_bing,
			};
			
				
			/*var overlayMaps = {
				"Infraestructura urbana":{
				"Parcelas Zonificadas":parce,
			
			
				
				
			};*/
			var groupedOverlays = {
				
				
				"Infraestructura Urbana":{
				"Parcelas Zonificadas":parcegrupo,
				
				
				},
			   
				
				
			};

			var opciones_groupedlayers = {
				groupCheckboxes: false
			};
		    //L.control.layers(baseMaps, overlayMaps).addTo(map);
			
		    L.control.groupedLayers(baseMaps, groupedOverlays, opciones_groupedlayers).addTo(map);
			map.on('overlayadd', onOverlayAdd);
		    map.on('overlayremove', onOverlayRemove);
			L.control.scale().addTo(map);
			L.control.polylineMeasure().addTo(map);
			
			
		</script>
	</body>
</html>
       

      
